<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta HTTP-EQUIV="EXPIRES" CONTENT="-1">
		<title>Computing Science 309 Warehouse Wars</title>
		<script language="javascript" src="jquery-3.1.1.min.js" > </script>
		<script language="javascript" src="ww.js" > </script>

		<script> 
			stage=null;
			interval=null;
			score=0;
			function alertStuff(data){ alert(JSON.stringify(data)); }
			function setupGame(){
				stage=new Stage(20,20,"stage");
				stage.initialize();
			}
			function startGame(){
				if(interval == null){
					interval = setInterval(step, 1000);
				}
			}
			function pauseGame(){
				clearInterval(interval);
				interval=null;
			}

			function loginFunction(){
		
			}
			function registerFunction(){
				var input = { "user": $("#registeruser").val(), "password": $("#registerpasswd").val(),
                                   "email": $("#registeremail").val()};
				var params = {
						method: "PUT",
						url: "api/api.php",
						data: JSON.stringify(input),
						processData: false,
						contentType: 'application/json; charset=UTF-8',
						dataType: "json"
					};
				$.ajax(params).done(alertStuff);
			}
			function movePlayer(direction){
				if(interval != null){
					stage.movePlayer(direction);
				}
			}
			function readKeyboard(event){

				if(interval != null){
					input = String.fromCharCode(event.keyCode);
					input = input.toLowerCase();

					if(input == "w") {
				    	stage.movePlayer("N");
				    }
				    if(input == "s") {
				    	stage.movePlayer("S");
				    }
				    if(input == "d") {
				    	stage.movePlayer("E");
				    }
				    if(input == "a") {
				    	stage.movePlayer("W");
				    }
				    if(input == "q") {
				    	stage.movePlayer("NW");
				    }
				    if(input == "e") {
				    	stage.movePlayer("NE");
				    }
				    if(input == "z") {
				    	stage.movePlayer("SW");
				    }
				    if(input == "c") {
				    	stage.movePlayer("SE");
				    }
					stage.step();
				}
			}
			function step(){
				stage.moveMonsters();
				stage.step();
				score++;
				$('#score').html(score);
			}

			$(function(){
				$('#LoginPage').show();
				$('#ProfilePage').hide();

				//setupGame();
				//startGame();

				document.addEventListener('keydown', function(event) { readKeyboard(event); });

				$('#RegisterButton').click(function(){ 
					$('#LoginPage').hide();
					$('#ProfilePage').show(); 

				});
				$('#LoginButton').click(function(){
					console.log("login clicked");
					loginFunction();
				});
				$('#submitRegister').click(function(){
					console.log("submit register clicked");
					registerFunction();
				});
			});
		</script>
		<style>
			#stage td {
				border:1px solid black;
			}
			#score {
				font-size: 250%;
			}
			.legend td {
				width:50px;
				text-align: center;
			}
			.legend td img {
				
    			margin-left: auto;
    			margin-right: auto;
    			display:block;
				border:1px solid black;
			}
			.controls td img {
				width:70px;
				height:70px;
			}

		</style>
	</head>
	<body bgcolor="ffffff">
		<center>
			<h1>Warehouse Wars</h1>


			<div id="LoginPage">
				<h1>Login</h1>
				<form>
					<fieldset>

						<legend>Login</legend>

						<p> <label for="user">User</label><input id="loginuser" type="text" name="user" value=""></input> </p>
						<p> <label for="password">Password</label><input id="loginpasswd" type="password" name="password"></input> </p>

						<input id="LoginButton" type="Button" value="Login"/>
						<input id="RegisterButton" type="Button" value ="Register"/>
						<input id="ForgotButton" type="Button" value ="Forgot Password"/>

					</fieldset>
				</form>	
			</div>

			<div id="ProfilePage">
				<h1>Profile</h1>
			    <form>
			        <fieldset>
			            <legend>Registration</legend>
			            <p><label for="user">User</label> <input id="registeruser" type="text" name="user">
			            <p><label for="password">Password</label><input id="registerpasswd" type="password" name="password">
			            <p><label for="email">email</label><input id="registeremail" type="text" name="email">
			            <p><input id="submitRegister" type="button" value="Submit"/>
			        </fieldset>

			</div>


			<table>
				<tr>
					<td> <div id="stage"> </div></td> 
					<td>
						<center>
							<h2>Score</h2> <div id="score"> &nbsp; </div>
							<h2>Legend</h2>
							<table class="legend">
								<tr>
									<td> <img src="icons/blank.gif" id="blankImage" /> </td>
									<td> <img src="icons/emblem-package-2-24.png" id="boxImage" /> </td>
									<td> <img src="icons/face-cool-24.png" id="playerImage" /> </td>
									<td> <img src="icons/face-devil-grin-24.png" id="monsterImage" /> </td>
									<td> <img src="icons/wall.jpeg" width="20px" height="20px" id="wallImage" /> </td>
								</tr>
								<tr>
									<td> Empty <br/> Square </td>
									<td> Box </td>
									<td> Player </td>
									<td> Monster </td>
									<td> Wall </td>
								</tr>
							</table>
							<h2>Controls</h2>
							<table class="controls">
								<tr>
									<td><img src="icons/north_west.svg" onclick=movePlayer('NW'); /></td>
									<td><img src="icons/north.svg" onclick=movePlayer('N'); /></td>
									<td><img src="icons/north_east.svg" onclick=movePlayer('NE'); /></td>
								</tr>
								<tr>
									<td><img src="icons/west.svg" onclick=movePlayer('W'); /></td>
									<td>&nbsp;</td>
									<td><img src="icons/east.svg" onclick=movePlayer('E'); /></td>
								</tr>
								<tr>
									<td><img src="icons/south_west.svg" onclick=movePlayer('SW'); /></td>
									<td><img src="icons/south.svg" onclick=movePlayer('S'); /></td>
									<td><img src="icons/south_east.svg" onclick=movePlayer('SE'); /></td>
								</tr>
							</table>
						</center>
					</td>
				</tr>
			</table>
		</center>
	</body>
</html>

